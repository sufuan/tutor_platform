import{r as t,a as H,j as e,H as I,b as O}from"./app-BUhuEzyO.js";import{u as R,A as W}from"./AuthenticatedLayout-CBwBHDdE.js";import{C as n,a as o,b as $,c as G,d as K}from"./card-D4GqX5A2.js";import{B as i}from"./button-CAVwRqY_.js";import{B as a}from"./badge-BLPlSDE4.js";import{I as N}from"./input-DtyJnP_z.js";import{S as Q,a as U,b as X,c as Z,d as _}from"./select-C2SRRxEK.js";import{D as ee,a as se,b as te,c as ae,d as ie,e as re}from"./dialog-D-HOYCHj.js";import{T as le}from"./textarea-CC8t-jC7.js";import{L as d}from"./label-BBiJJFWY.js";import"./alert-Can3j94R.js";import{L as ce}from"./LocationDropdown-CRHwayXC.js";import{C as ne}from"./heroicons-currency-bangladeshi-DXzXXx6H.js";import{B as oe}from"./book-open-DiDEiOqw.js";import{S as de}from"./search-ClmUHlup.js";import{B as me,F as xe}from"./file-text-BSy-X-yT.js";import{E as pe}from"./external-link-OR1BCjhY.js";import{M as he}from"./map-pin-qH5cKYLu.js";import{C as ue}from"./calendar-D9MECdF2.js";import{C as je}from"./clock-CrlJfTgx.js";import{E as fe}from"./eye-DMVe5Li_.js";import{S as ve}from"./send-BjaZ2MPA.js";import"./sheet-DQNJyJai.js";import"./index-BYMPJu14.js";import"./index-C29P68Fh.js";import"./check-DA1oTTe0.js";import"./circle-DynfTCfo.js";import"./index-ooFNt-PP.js";import"./house-DGNOOO1l.js";import"./user-CAND1Ilh.js";import"./users-CE_h5m1u.js";import"./mail-Dm9IeIB1.js";import"./index-BZJhQN7D.js";import"./chevron-down-BaHI1BPP.js";function es({auth:S,jobs:D,locations:ge,subjects:F,verificationStatus:A,tutorCv:y}){const[m,V]=t.useState(""),[x,B]=t.useState(""),[p,L]=t.useState(""),[h,k]=t.useState("all"),[T,r]=t.useState(!1),[b,u]=t.useState(null),{toast:J}=R(),{data:j,setData:f,post:P,processing:w,reset:C,errors:l}=H({cover_letter:"",cv_path:null}),M=s=>{if(A!=="verified"){J({variant:"destructive",title:"Verification Required",description:"You must be verified before applying to jobs. Please complete the verification process."});return}u(s),r(!0)},E=s=>{s.preventDefault(),P(route("tutor.jobs.apply",b.id),{onSuccess:()=>{r(!1),u(null),C()},forceFormData:!0})},c=D.filter(s=>{const v=s.title.toLowerCase().includes(m.toLowerCase())||s.description.toLowerCase().includes(m.toLowerCase()),g=!x||s.division===x,Y=!p||s.district===p,z=h==="all"||s.subjects&&s.subjects.includes(h);return v&&g&&Y&&z}),q=({job:s})=>e.jsxs(n,{className:"hover:shadow-lg transition-shadow",children:[e.jsx($,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(G,{className:"text-xl mb-2",children:s.title}),e.jsxs(K,{children:["Posted by ",s.guardian?.first_name," ",s.guardian?.last_name]})]}),s.has_applied&&e.jsx(a,{variant:"secondary",children:"Applied"})]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(he,{className:"h-4 w-4"}),e.jsx("span",{children:s.location?.name})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ne,{size:16,className:" "}),e.jsxs("span",{className:"font-semibold text-green-600",children:[s.salary,"/month"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ue,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.days_per_week," days/week"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(je,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.duration_per_session," mins"]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Subjects Required:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[Array.isArray(s.subject_names)&&s.subject_names.slice(0,4).map((v,g)=>e.jsx(a,{variant:"secondary",className:"text-xs",children:v},g)),Array.isArray(s.subject_names)&&s.subject_names.length>4&&e.jsxs(a,{variant:"secondary",className:"text-xs",children:["+",s.subject_names.length-4," more"]})]})]}),e.jsxs("div",{className:"flex gap-2 items-center text-xs text-gray-500",children:[e.jsx(a,{variant:"outline",children:s.education_medium}),e.jsx(a,{variant:"outline",children:s.tuition_type}),e.jsx(a,{variant:"outline",children:s.class_level})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(i,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>O.visit(route("jobs.show",s.id)),children:[e.jsx(fe,{className:"mr-2 h-4 w-4"}),"View Details"]}),!s.has_applied&&e.jsxs(i,{size:"sm",className:"flex-1",onClick:()=>M(s),children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),"Apply Now"]})]})]})]});return e.jsxs(W,{children:[e.jsx(I,{title:"Browse Jobs"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Browse Available Jobs"}),e.jsx("p",{className:"text-gray-600",children:"Find the perfect tutoring opportunity"})]}),S.tutor?.verification_status!=="verified"&&e.jsx(n,{className:"mb-6 border-yellow-200 bg-yellow-50",children:e.jsx(o,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-yellow-100 flex items-center justify-center",children:e.jsx(oe,{className:"h-5 w-5 text-yellow-600"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-yellow-900",children:"Verification Pending"}),e.jsx("p",{className:"text-sm text-yellow-800 mt-1",children:"Your profile is currently under verification. You can browse jobs but may have limited application capabilities until verified."})]})]})})}),e.jsx(n,{className:"mb-6",children:e.jsx(o,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(de,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(N,{placeholder:"Search jobs by title or description...",value:m,onChange:s=>V(s.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(ce,{divisionValue:x,districtValue:p,onDivisionChange:B,onDistrictChange:L,divisionLabel:"Filter by Division",districtLabel:"Filter by District",showLabels:!0}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Subject"}),e.jsxs(Q,{value:h,onValueChange:k,children:[e.jsx(U,{children:e.jsx(X,{})}),e.jsxs(Z,{children:[e.jsx(_,{value:"all",children:"All Subjects"}),F.map(s=>e.jsx(_,{value:s.name,children:s.name},s.id))]})]})]})]})]})})}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",c.length," ",c.length===1?"job":"jobs"]})}),c.length===0?e.jsx(n,{children:e.jsxs(o,{className:"pt-6 text-center py-12",children:[e.jsx(me,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No jobs found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search criteria"})]})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:c.map(s=>e.jsx(q,{job:s},s.id))})]})}),e.jsx(ee,{open:T,onOpenChange:r,children:e.jsxs(se,{className:"max-w-2xl",children:[e.jsxs(te,{children:[e.jsx(ae,{children:"Apply for Job"}),e.jsx(ie,{children:b?.title})]}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"cover_letter",children:"Cover Letter *"}),e.jsx(le,{id:"cover_letter",placeholder:"Write a brief introduction about yourself and why you're a good fit for this position...",rows:6,value:j.cover_letter,onChange:s=>f("cover_letter",s.target.value),required:!0}),l.cover_letter&&e.jsx("p",{className:"text-sm text-red-500",children:l.cover_letter}),e.jsx("p",{className:"text-xs text-gray-500",children:"Tip: Mention your relevant experience and qualifications for this specific job"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Curriculum Vitae (CV)"}),y?e.jsxs("div",{className:"border rounded-lg p-4 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5 text-slate-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Your CV from Profile"}),e.jsx("p",{className:"text-xs text-slate-500",children:"This CV will be attached to your application"})]})]}),e.jsxs(i,{type:"button",variant:"outline",size:"sm",onClick:()=>window.open(`/storage/${y}`,"_blank"),children:[e.jsx(pe,{className:"h-4 w-4 mr-1"}),"View CV"]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t",children:[e.jsx(d,{htmlFor:"cv_upload",className:"text-sm text-slate-600",children:"Or upload a different CV (PDF only, max 5MB)"}),e.jsx(N,{id:"cv_upload",type:"file",accept:".pdf",className:"mt-2",onChange:s=>f("cv_path",s.target.files[0])}),j.cv_path&&e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["New CV selected: ",j.cv_path.name]})]})]}):e.jsxs("div",{children:[e.jsx(N,{id:"cv_upload",type:"file",accept:".pdf",onChange:s=>f("cv_path",s.target.files[0]),required:!0}),e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"You haven't uploaded a CV in your profile. Please upload one here (PDF only, max 5MB)"})]}),l.cv_path&&e.jsx("p",{className:"text-sm text-red-500",children:l.cv_path})]}),e.jsxs(re,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>{r(!1),u(null),C()},children:"Cancel"}),e.jsx(i,{type:"submit",disabled:w,children:w?"Submitting...":"Submit Application"})]})]})]})})]})}export{es as default};
