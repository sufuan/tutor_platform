import{r as u,a as O,j as e,H as M,b as y}from"./app-DsllCRkg.js";import{A as U,F as V}from"./AuthenticatedLayout-C7FLhRCs.js";import{C as r,a as i,b as G,c as X,d as I}from"./card-5u8WTilj.js";import{B as l}from"./button-CoTJxXaf.js";import{B as a}from"./badge-B200-mJa.js";import{D as f,a as _,b,c as w,d as C,e as A}from"./dialog-Br4z9Dnm.js";import{T as K}from"./textarea-BuKTeqfs.js";import{L as Q}from"./label-C3nxLCEe.js";import{T as W,a as Y,b as v,c as N}from"./tabs-7akIjqNY.js";import{B as Z}from"./file-text-CnOATaiY.js";import{C as R}from"./circle-check-big-DMtVIVnt.js";import{C as D}from"./circle-x-DrYTQECN.js";import{U as ee}from"./user-0eZu2NEE.js";import{M as k}from"./map-pin-BdKcBnaD.js";import{D as se}from"./dollar-sign-Dnuw22R_.js";import{C as J}from"./calendar-BxaILTC_.js";import{C as ae}from"./clock-WiQn5WRQ.js";import{E as te}from"./eye-CRNGiFUP.js";import"./sheet-3K8_wCSN.js";import"./index-audHxnvk.js";import"./index-Cd5ZZqyH.js";import"./check-DGBoWBRM.js";import"./circle-OtpwoAGW.js";import"./input-D-PX5_cd.js";import"./index-CCrlpGWa.js";import"./house-vDFQtZPY.js";import"./search-AC4RCcwv.js";import"./users-CCfAm_xt.js";import"./book-open-C4UPpF1Q.js";import"./mail-BNel7RtU.js";function Pe({auth:re,jobs:m,stats:h}){const[n,c]=u.useState(null),[S,d]=u.useState(!1),[T,o]=u.useState(!1),{data:j,setData:q,post:ie,processing:p,reset:B}=O({rejection_reason:""}),F=s=>{c(s),d(!0)},P=()=>{const s=n.job_type==="tutor"?"admin.tutor-job-requests.approve":"admin.jobs.approve";y.post(route(s,n.id),{},{onSuccess:()=>{d(!1),c(null)}})},$=s=>{c(s),o(!0)},E=()=>{const s=n.job_type==="tutor"?"admin.tutor-job-requests.reject":"admin.jobs.reject";y.post(route(s,n.id),{rejection_reason:j.rejection_reason},{onSuccess:()=>{o(!1),c(null),B()}})},z=s=>({pending:"bg-yellow-100 text-yellow-800 border-yellow-200",approved:"bg-green-100 text-green-800 border-green-200",rejected:"bg-red-100 text-red-800 border-red-200"})[s]||"bg-gray-100 text-gray-800 border-gray-200",t={pending:m.filter(s=>s.approval_status==="pending"),approved:m.filter(s=>s.approval_status==="approved"),rejected:m.filter(s=>s.approval_status==="rejected")},g=({job:s})=>e.jsxs(r,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(G,{children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(a,{variant:"outline",className:s.job_type==="tutor"?"bg-blue-100 text-blue-800 border-blue-200":"bg-purple-100 text-purple-800 border-purple-200",children:s.job_type==="tutor"?"Tutor Request":"Guardian Post"}),e.jsx(a,{variant:"outline",className:z(s.approval_status),children:s.approval_status}),s.applications_count>0&&e.jsxs(a,{variant:"secondary",children:[s.applications_count," applications"]})]}),e.jsx(X,{className:"text-xl",children:s.title}),e.jsx(I,{children:s.job_type==="tutor"?`Tutor Code: ${s.tutor?.tutor_code}`:`Job Code: ${s.job_code}`})]})})}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsxs("span",{children:["Posted by: ",s.job_type==="tutor"?s.tutor?.user?.name:`${s.guardian?.first_name} ${s.guardian?.last_name}`]})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-3",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[s.job_type==="guardian"&&s.location?.name&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:s.location?.name})]}),s.job_type==="tutor"&&(s.division||s.district)&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.district,", ",s.division]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["à§³",s.job_type==="tutor"?s.monthly_salary:s.salary,"/month"]})]}),s.job_type==="guardian"&&s.days_per_week&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.days_per_week," days/week"]})]}),s.job_type==="tutor"&&s.available_days&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsxs("span",{children:[Array.isArray(s.available_days)?s.available_days.length:0," days/week"]})]}),s.job_type==="guardian"&&s.duration_per_session&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.duration_per_session," mins"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Subjects:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(()=>{let x=[];return s.job_type==="tutor"?x=s.subject_names||[]:x=typeof s.subjects=="string"?JSON.parse(s.subjects||"[]"):s.subjects||[],x.map((H,L)=>e.jsx(a,{variant:"secondary",className:"text-xs",children:H},L))})()})]}),s.job_type==="guardian"&&e.jsxs("div",{className:"flex gap-2 items-center text-xs",children:[e.jsx(a,{variant:"outline",children:s.education_medium}),e.jsx(a,{variant:"outline",children:s.tuition_type}),e.jsx(a,{variant:"outline",children:s.class_level}),s.preferred_tutor_gender!=="any"&&e.jsxs(a,{variant:"outline",children:[s.preferred_tutor_gender," tutor"]})]}),s.job_type==="tutor"&&e.jsxs("div",{className:"flex gap-2 items-center text-xs",children:[e.jsx(a,{variant:"outline",children:s.teaching_mode}),s.preferred_gender&&e.jsxs(a,{variant:"outline",className:"capitalize",children:[s.preferred_gender," tutor"]})]}),s.special_requirements&&e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Special Requirements:"}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:s.special_requirements})]}),s.rejection_reason&&e.jsxs("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-xs text-red-600 mb-1",children:"Rejection Reason:"}),e.jsx("p",{className:"text-sm text-red-800",children:s.rejection_reason})]}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[e.jsxs(l,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>{s.job_type==="tutor"?window.open(`/admin/tutor-job-requests/${s.id}`,"_blank"):window.open(`/admin/jobs/${s.id}`,"_blank")},children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"View Details"]}),s.approval_status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(l,{size:"sm",onClick:()=>F(s),children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Approve"]}),e.jsxs(l,{variant:"destructive",size:"sm",onClick:()=>$(s),children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"Reject"]})]})]})]})]});return e.jsxs(U,{children:[e.jsx(M,{title:"Job Approvals"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(r,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:h.pending}),e.jsx("div",{className:"text-sm text-gray-600",children:"Pending Approval"})]})})}),e.jsx(r,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:h.approved}),e.jsx("div",{className:"text-sm text-gray-600",children:"Approved Jobs"})]})})}),e.jsx(r,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:h.rejected}),e.jsx("div",{className:"text-sm text-gray-600",children:"Rejected"})]})})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(V,{className:"h-8 w-8"}),"Job Approvals"]}),e.jsx("p",{className:"text-gray-600",children:"Review and approve job postings"})]}),e.jsxs(W,{defaultValue:"pending",className:"space-y-4",children:[e.jsxs(Y,{className:"grid w-full grid-cols-3",children:[e.jsxs(v,{value:"pending",children:["Pending (",t.pending.length,")"]}),e.jsxs(v,{value:"approved",children:["Approved (",t.approved.length,")"]}),e.jsxs(v,{value:"rejected",children:["Rejected (",t.rejected.length,")"]})]}),e.jsx(N,{value:"pending",className:"space-y-4",children:t.pending.length===0?e.jsx(r,{children:e.jsxs(i,{className:"pt-6 text-center py-12",children:[e.jsx(Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No pending jobs"}),e.jsx("p",{className:"text-gray-600",children:"All job postings have been reviewed"})]})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:t.pending.map(s=>e.jsx(g,{job:s},s.id))})}),e.jsx(N,{value:"approved",className:"space-y-4",children:t.approved.length===0?e.jsx(r,{children:e.jsxs(i,{className:"pt-6 text-center py-12",children:[e.jsx(R,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No approved jobs"}),e.jsx("p",{className:"text-gray-600",children:"Approved jobs will appear here"})]})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:t.approved.map(s=>e.jsx(g,{job:s},s.id))})}),e.jsx(N,{value:"rejected",className:"space-y-4",children:t.rejected.length===0?e.jsx(r,{children:e.jsxs(i,{className:"pt-6 text-center py-12",children:[e.jsx(D,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No rejected jobs"}),e.jsx("p",{className:"text-gray-600",children:"Rejected jobs will appear here"})]})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:t.rejected.map(s=>e.jsx(g,{job:s},s.id))})})]})]})}),e.jsx(f,{open:S,onOpenChange:d,children:e.jsxs(_,{children:[e.jsxs(b,{children:[e.jsx(w,{children:"Approve Job"}),e.jsxs(C,{children:['Confirm approval for "',n?.title,'"']})]}),e.jsx("div",{className:"py-4",children:e.jsx("p",{className:"text-sm text-gray-600",children:"This job will be published and visible to all tutors on the platform."})}),e.jsxs(A,{children:[e.jsx(l,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(l,{onClick:P,disabled:p,children:p?"Approving...":"Approve Job"})]})]})}),e.jsx(f,{open:T,onOpenChange:o,children:e.jsxs(_,{children:[e.jsxs(b,{children:[e.jsx(w,{children:"Reject Job"}),e.jsxs(C,{children:['Provide a reason for rejecting "',n?.title,'"']})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"rejection_reason",children:"Rejection Reason *"}),e.jsx(K,{id:"rejection_reason",placeholder:"Explain why this job posting is being rejected...",rows:4,value:j.rejection_reason,onChange:s=>q("rejection_reason",s.target.value),required:!0})]})}),e.jsxs(A,{children:[e.jsx(l,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(l,{variant:"destructive",onClick:E,disabled:p||!j.rejection_reason,children:p?"Rejecting...":"Reject Job"})]})]})})]})}export{Pe as default};
