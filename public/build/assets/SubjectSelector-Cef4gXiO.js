import{r as l,j as r}from"./app-esU2hYCN.js";import{I as C}from"./input-BoE5SyXR.js";import{L as A}from"./label-BoMPP-uh.js";import{B as w}from"./badge-CXqMxkob.js";import{B as k}from"./button-DfijBdcy.js";import{C as x,a as h}from"./card-B_xZCLU1.js";import{S as B,a as I,b as L,c as M,d as u}from"./select-Cm_5_6nT.js";import{C as E}from"./check-D2YdfQDL.js";import{X as T}from"./sheet-8EdXQCVw.js";import{S as F}from"./search-kBGoqgui.js";function K({subjects:t=[],selectedSubjects:n=[],onSubjectsChange:i,label:p="Subjects",placeholder:g="Search subjects..."}){const[c,f]=l.useState(""),[o,y]=l.useState("all"),s=l.useMemo(()=>{if(Array.isArray(n))return n.map(e=>parseInt(e));if(typeof n=="string")try{const e=JSON.parse(n);return Array.isArray(e)?e.map(a=>parseInt(a)):[]}catch{return[]}return[]},[n]),j=l.useMemo(()=>{const e=new Set;return t.forEach(a=>{a.category?.name&&e.add(a.category.name)}),Array.from(e).sort()},[t]),m=l.useMemo(()=>t.filter(e=>{const a=e.name.toLowerCase().includes(c.toLowerCase()),N=o==="all"||e.category?.name===o,S=!s.includes(e.id);return a&&N&&S}),[t,c,o,s]),d=l.useMemo(()=>t.filter(e=>s.includes(e.id)),[t,s]),v=e=>{s.includes(e)||i([...s,e])},b=e=>{i(s.filter(a=>a!==e))};return r.jsxs("div",{className:"space-y-4",children:[r.jsx(A,{children:p}),d.length>0&&r.jsx(x,{className:"bg-blue-50 border-blue-200",children:r.jsxs(h,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("span",{className:"text-sm font-medium text-blue-900",children:["Selected Subjects (",d.length,")"]}),r.jsx(k,{type:"button",variant:"ghost",size:"sm",onClick:()=>i([]),className:"h-6 text-xs text-blue-700 hover:text-blue-900",children:"Clear All"})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(e=>r.jsxs(w,{variant:"secondary",className:"bg-blue-100 text-blue-900 border-blue-300 hover:bg-blue-200 pr-1 text-sm",children:[r.jsx(E,{className:"h-3 w-3 mr-1"}),e.name,r.jsx("button",{type:"button",onClick:()=>b(e.id),className:"ml-1 hover:bg-blue-300 rounded-full p-0.5",children:r.jsx(T,{className:"h-3 w-3"})})]},e.id))})]})}),r.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"relative",children:[r.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.jsx(C,{placeholder:g,value:c,onChange:e=>f(e.target.value),className:"pl-9"})]}),r.jsxs(B,{value:o,onValueChange:y,children:[r.jsx(I,{children:r.jsx(L,{placeholder:"All Categories"})}),r.jsxs(M,{children:[r.jsx(u,{value:"all",children:"All Categories"}),j.map(e=>r.jsx(u,{value:e,children:e},e))]})]})]}),r.jsx(x,{children:r.jsxs(h,{className:"p-4",children:[r.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["Click to add subjects (",m.length," available)"]}),r.jsx("div",{className:"max-h-64 overflow-y-auto",children:m.length>0?r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:m.map(e=>r.jsxs("button",{type:"button",onClick:()=>v(e.id),className:"text-left p-2 border rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-all text-sm",children:[r.jsx("div",{className:"font-medium text-gray-900",children:e.name}),e.category?.name&&r.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:e.category.name})]},e.id))}):r.jsx("div",{className:"text-center py-8 text-gray-500",children:c||o!=="all"?r.jsx("p",{children:"No subjects found matching your search"}):r.jsx("p",{children:"All subjects have been selected"})})})]})})]})}export{K as S};
