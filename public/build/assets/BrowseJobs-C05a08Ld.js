import{r as l,a as A,b as U,j as e,H as W}from"./app-B63PtWLD.js";import{u as X,A as G}from"./AuthenticatedLayout-Dvnz6xi2.js";import{C as x,c as p,a as K,b as Q,d as Z}from"./card-BmOj17mn.js";import{B as r}from"./button-DV66Woy4.js";import{B as i}from"./badge-CptsXR4E.js";import{I as g}from"./input-7u4n2Okz.js";import{S as D,a as V,b as B,c as F,d as h}from"./select-BavsaryR.js";import{D as ee,a as se,b as ae,c as te,d as le,e as re}from"./dialog-DpDO0qUS.js";import{T as ie}from"./textarea-pbmQ4V_b.js";import{L as n}from"./label-DE4bO72r.js";import"./alert-BgwIzEf5.js";import{C as ce}from"./heroicons-currency-bangladeshi-Ba-A20Yx.js";import{B as ne}from"./book-open-Be65WJkb.js";import{S as oe}from"./search-D6E_4M0f.js";import{X as de}from"./sheet-lUi-JFXN.js";import{B as me,F as xe}from"./file-text-Bimclqna.js";import{E as pe}from"./external-link-BTnRB1yf.js";import{M as he}from"./map-pin-CSOFZLi8.js";import{C as ue}from"./calendar-fpUwf_Dj.js";import{C as je}from"./clock-DfXsplzp.js";import{E as fe}from"./eye-Cc-P3UvI.js";import{S as ve}from"./send-CGippFw-.js";import"./index-D3bRAgg9.js";import"./index-B3FaZpoj.js";import"./index-fjpr62jj.js";import"./house-BoNy_Mq9.js";import"./user-hj4MECco.js";import"./users-DI88Xr7j.js";import"./mail-D8OkAqz4.js";import"./index-CYY9-CdH.js";import"./chevron-down-CZNvS6TH.js";import"./check-BgUT7JlC.js";import"./circle-CKE4H3am.js";function Qe({auth:T,jobs:o,districts:k,subjects:P,verificationStatus:L,tutorCv:N,filters:u}){const[c,y]=l.useState(u.search||""),[a,b]=l.useState(u.location||""),[t,w]=l.useState(u.subject||""),[E,d]=l.useState(!1),[C,j]=l.useState(null),{toast:J}=X();l.useEffect(()=>{const s=setTimeout(()=>{M()},500);return()=>clearTimeout(s)},[c,a,t]);const M=()=>{const s={};c&&(s.search=c),a&&a!=="all"&&(s.location=a),t&&t!=="all"&&(s.subject=t),A.get(route("tutor.jobs.browse"),s,{preserveState:!0,preserveScroll:!0})},q=()=>{y(""),b(""),w("")},z=c||a&&a!=="all"||t&&t!=="all",{data:f,setData:v,post:Y,processing:_,reset:S,errors:m}=U({cover_letter:"",cv_path:null}),H=s=>{if(L!=="verified"){J({variant:"destructive",title:"Verification Required",description:"You must be verified before applying to jobs. Please complete the verification process."});return}j(s),d(!0)},I=s=>{s.preventDefault(),Y(route("tutor.jobs.apply",C.id),{onSuccess:()=>{d(!1),j(null),S()},forceFormData:!0})},O=({job:s})=>e.jsxs(x,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(K,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(Q,{className:"text-xl mb-2",children:s.title}),e.jsxs(Z,{children:["Posted by ",s.guardian?.first_name," ",s.guardian?.last_name]})]}),s.has_applied&&e.jsx(i,{variant:"secondary",children:"Applied"})]})}),e.jsxs(p,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(he,{className:"h-4 w-4"}),e.jsx("span",{children:s.district&&s.division?`${s.district}, ${s.division}`:s.location?.city||"Not specified"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ce,{size:16,className:" "}),e.jsxs("span",{className:"font-semibold text-green-600",children:[s.salary,"/month"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ue,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.days_per_week," days/week"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(je,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.duration_per_session," mins"]})]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Posted ",new Date(s.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Subjects Required:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[Array.isArray(s.subject_names)&&s.subject_names.slice(0,4).map((R,$)=>e.jsx(i,{variant:"secondary",className:"text-xs",children:R},$)),Array.isArray(s.subject_names)&&s.subject_names.length>4&&e.jsxs(i,{variant:"secondary",className:"text-xs",children:["+",s.subject_names.length-4," more"]})]})]}),e.jsxs("div",{className:"flex gap-2 items-center text-xs text-gray-500",children:[e.jsx(i,{variant:"outline",children:s.education_medium}),e.jsx(i,{variant:"outline",children:s.tuition_type}),e.jsx(i,{variant:"outline",children:s.class_level})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(r,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>A.visit(route("jobs.show",s.id)),children:[e.jsx(fe,{className:"mr-2 h-4 w-4"}),"View Details"]}),!s.has_applied&&e.jsxs(r,{size:"sm",className:"flex-1",onClick:()=>H(s),children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),"Apply Now"]})]})]})]});return e.jsxs(G,{children:[e.jsx(W,{title:"Browse Jobs"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Browse Available Jobs"}),e.jsx("p",{className:"text-gray-600",children:"Find the perfect tutoring opportunity"})]}),T.tutor?.verification_status!=="verified"&&e.jsx(x,{className:"mb-6 border-yellow-200 bg-yellow-50",children:e.jsx(p,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-yellow-100 flex items-center justify-center",children:e.jsx(ne,{className:"h-5 w-5 text-yellow-600"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-yellow-900",children:"Verification Pending"}),e.jsx("p",{className:"text-sm text-yellow-800 mt-1",children:"Your profile is currently under verification. You can browse jobs but may have limited application capabilities until verified."})]})]})})}),e.jsx(x,{className:"mb-6",children:e.jsx(p,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(oe,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(g,{placeholder:"Search jobs by title or description...",value:c,onChange:s=>y(s.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"District"}),e.jsxs(D,{value:a,onValueChange:b,children:[e.jsx(V,{children:e.jsx(B,{placeholder:"All Districts"})}),e.jsxs(F,{children:[e.jsx(h,{value:"all",children:"All Districts"}),k.map(s=>e.jsx(h,{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Subject"}),e.jsxs(D,{value:t,onValueChange:w,children:[e.jsx(V,{children:e.jsx(B,{placeholder:"All Subjects"})}),e.jsxs(F,{children:[e.jsx(h,{value:"all",children:"All Subjects"}),P.map(s=>e.jsx(h,{value:s.name,children:s.name},s.id))]})]})]})]}),z&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(r,{onClick:q,variant:"outline",size:"sm",children:[e.jsx(de,{className:"h-4 w-4 mr-1"}),"Clear Filters"]})})]})})}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",o.length," ",o.length===1?"job":"jobs"]})}),o.length===0?e.jsx(x,{children:e.jsxs(p,{className:"pt-6 text-center py-12",children:[e.jsx(me,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No jobs found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search criteria"})]})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:o.map(s=>e.jsx(O,{job:s},s.id))})]})}),e.jsx(ee,{open:E,onOpenChange:d,children:e.jsxs(se,{className:"max-w-2xl",children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Apply for Job"}),e.jsx(le,{children:C?.title})]}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"cover_letter",children:"Cover Letter *"}),e.jsx(ie,{id:"cover_letter",placeholder:"Write a brief introduction about yourself and why you're a good fit for this position...",rows:6,value:f.cover_letter,onChange:s=>v("cover_letter",s.target.value),required:!0}),m.cover_letter&&e.jsx("p",{className:"text-sm text-red-500",children:m.cover_letter}),e.jsx("p",{className:"text-xs text-gray-500",children:"Tip: Mention your relevant experience and qualifications for this specific job"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Curriculum Vitae (CV)"}),N?e.jsxs("div",{className:"border rounded-lg p-4 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5 text-slate-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Your CV from Profile"}),e.jsx("p",{className:"text-xs text-slate-500",children:"This CV will be attached to your application"})]})]}),e.jsxs(r,{type:"button",variant:"outline",size:"sm",onClick:()=>window.open(`/storage/${N}`,"_blank"),children:[e.jsx(pe,{className:"h-4 w-4 mr-1"}),"View CV"]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t",children:[e.jsx(n,{htmlFor:"cv_upload",className:"text-sm text-slate-600",children:"Or upload a different CV (PDF only, max 5MB)"}),e.jsx(g,{id:"cv_upload",type:"file",accept:".pdf",className:"mt-2",onChange:s=>v("cv_path",s.target.files[0])}),f.cv_path&&e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["New CV selected: ",f.cv_path.name]})]})]}):e.jsxs("div",{children:[e.jsx(g,{id:"cv_upload",type:"file",accept:".pdf",onChange:s=>v("cv_path",s.target.files[0]),required:!0}),e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"You haven't uploaded a CV in your profile. Please upload one here (PDF only, max 5MB)"})]}),m.cv_path&&e.jsx("p",{className:"text-sm text-red-500",children:m.cv_path})]}),e.jsxs(re,{children:[e.jsx(r,{type:"button",variant:"outline",onClick:()=>{d(!1),j(null),S()},children:"Cancel"}),e.jsx(r,{type:"submit",disabled:_,children:_?"Submitting...":"Submit Application"})]})]})]})})]})}export{Qe as default};
